---
title: Brevo
created: 2024-05-09 12:42
last modified: Thursday 9th May 2024 12:42:44
aliases: 
tags:
  - winwintravel
---
# Brevo

Ця документація описує як тестувати `brevo` - систему для збору статистики

## Передумови

Для тестування у вас повинен бути доступ до `brevo`, якщо у вас його немає - звертайтесь до Вадима

## Опис сутностей

`Brevo` досить проста система, яка складається з двох основих сутностей:
- `Contact` - один запис, можна уявити як запис в базі данних або ж строка в таблиці
- `List` - список, який в собі може містити контакти

Є важливий нюанс в тому, що контакт не належить списку, а є окремою глобальною сутністью. Що це значить?
1. Контакт може належати до декількох списків одночасно
2. Якщо ми спробуємо створити в якомусь списку контакт з поштою(дивіться нижче параметри контакта), але вже десь є контакт з такою самою поштою у нас виникне помилка(окрім деяких ситуацій, які будуть описанні пізніше)

### Contact

У контакту є наступні **важливі** поля:
- `EMAIL` - Найбільш важливе поле. Пошта користувача
- `REQUEST_DISCOUNT_VALUE` - Данні з *request discount modal*
- `NPS_RESPONSE` - Дані з текстового поля `nps` модалки
- `NPS_SCORE` - Дані оцінки з `nps` модалки

### List

У нас в `brevo` є наступні списки:
- `LoginMobile` - Контакти людей, які реєструвались з телефона або планшета
- `Login` - Контакти людей, які реєструвались з комп'ютера
- `NPS` - Запити про оцінку сайту
- `discountRequests` - Записи про запит скидки
- `Langing` - Контакти з лендінгу. Вони нам не дуже потрібні

## Використання

### Login

Коли користувач вводить пошту з комп'ютера в список `Login` додається або новий контакт, якщо контакту з такою поштою не має, **або ж існуючий контакт додається в цей список**

Точно так само працює `LoginMobile`

При цьому поля `NPS_*` та `REQUEST_DISCOUNT_VALUE` не використовуються

### NPS

Коли користувач відправляє `NPS` модалку в спискі `NPS` створюється новий контакт формату:
- email: `{timestamp}-{email}` 
- nps_response: `{text}`
- nps_score: `{number}`

! Навіщо в email записувати такий формат? Це потрібно для створення точно нового та унікального контакту, щоб ми могли відслідкувати історію користувача, оскільки в різні моменти часу користувач може обирати різні `score`

## Request discount

Коли користувач відправляє `Request discount` модалку в спискі `discountRequests` створюється новий контакт формату:
- email: `{timestamp}-{email}` 
- REQUEST_DISCOUNT_VALUE: `{json}`

Чому `email` має такий формат було описанно в `NPS`

Чому `REQUEST_DISCOUNT_VALUE` записується в форматі `json`? Бо нам потрібно зберегти багато полів одночасно і це найкращий варіант, який є
